---
import image from 'astro:assets';
//1.バンドのデータを作成
//これを書くと後でHTMLを3回コピペしなくても自動で3つ作れるようになる
//youtubeIdを1つでなく、videosという箱の中に3つ入れる形に変える
const bands = [
	{
		name : "BUMP OF CHICKEN",
		description: "4人組ロックバンド。  【代表曲】天体観測 / 【有名曲】アカシア / 【好きな曲】望遠のマーチ",
		genre : "J-Rock",
		//youtubeIdじゃなくてvideosという箱の中に3つ入れる形に変える
		videos:{
		representative : "j7CDb610Bg0", //代表曲 (天体観測)
		famous: "4dnT-kKIO6Y", //有名曲 (アカシア)
		favorite:"Fk4sgvvHyeI" //好きな曲 (望遠のマーチ)
		}
	},
	{
		name : "UNISON SQUARE GARDEN",
		description : "3人組ロックバンド。  【代表曲】シュガーソングとビターステップ / 【有名曲】オリオンをなぞる / 【好きな曲】春が来て僕ら",
		genre : "J-Rock",
		videos:{
			representative : "3exsRhw3xt8", //代表曲(シュガビタ)
			famous : "Lw5o2pSrVbQ", //有名曲(オリオンをなぞる)
			favorite : "vrd95QQe6Gc" //好きな曲(春が来て僕ら)
		}
	},
	{
		name : "THE ORAL CIGARETTES",
		description: "4人組ロックバンド。  【代表曲】狂乱HeyKids!! / 【有名曲】起死回生STORY / 【好きな曲】愁",
		genre : "J-Rock",
		videos:{
			representation : "C-o8pTi6vd8", //代表曲(狂乱HeyKids!!)
			famous : "LqIbaicDP7A", //有名曲(起死回生STORY)
			favorite : "aBdrpVAr5-E" //好きな曲(愁)
		}
	},
	{
		name : "PompadollS",
		description : "5人組正統進化型・邦楽ロックバンド。  【代表曲】悪食 / 【有名曲】スポットライトジャンキー / 【好きな曲】日の東、月の西",
		genre : "正統進化型 J-Rock",
		videos:{
			representation : "nbYIDyGtOps", //代表曲(悪食)
			famous :"_jTYrUhm3vw", //有名曲(スポットライトジャンキー)
			favorite : "v6Bd19sNiWc" //好きな曲(日の東、月の西)
		}
	}
];
---
<html lang="ja">
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content = "width=device-width"/>
		<title> My Favorite Bands </title>
	</head>

	<body class="bg-slate-900 text-white font-sans">
		<header class="h-screen flex flex-col justify-center items-center text self-center">
			<h1 class="text-6xl font-bold mb-4 header-title opacity-0">
				My Favorite Artist
			</h1>
			<p class="text-xl text-slate-400 header-subtitle opacity-0 translate-y-10">
				presented by hayata
			</p>
		</header>

		<main class="max-w-4xl mx-auto px-4 py-20">
			{bands.map((band) =>(
				<article class="band-card mb-32 p-4 border border-slate-700 rounded-lg bg-slate-800 opacity-0 translate-x-[-50px]">
				<span class="text-sm font-bold text-blue-400 block mb-2">{band.genre}</span>
				<h2 class="text-3xl font-bold mb-4">{band.name}</h2>
				<p class="text-slate-300">{band.description}</p>
			<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
			{/* 1. 代表曲 */}
			<div class="flex flex-col gap-2">
				<h3 class="font-bold text-blue-300">【代表曲】</h3>
				<div class="w-full aspect-video rounded-md overflow-hidden bg-black">
				<iframe
				class="w-full h-full"
				src={`https://www.youtube.com/embed/${band.videos.representative}`}
				title="Representative Song"
				frameborder="0"
				allow="accelerometer; autoplay;..."
				allowfullscreen>
				</iframe>
				</div>
				</div>
			{/* 2. 有名曲 */}
			<div class="flex flex-col gap-2">
				<h3 class="font-bold text-green-300">【有名曲】</h3>
				<div class="w-full aspect-video rounded-md overflow-hidden bg-black">
				<iframe
				class="w-full h-full"
				src={`https://www.youtube.com/embed/${band.videos.famous}`}
				title="Representative Song"
				frameborder="0"
				allow="accelerometer; autoplay;..."
				allowfullscreen>
			</iframe>
			</div>
			</div>
			{/* 3. 好きな曲 */}
                        <div class="flex flex-col gap-2">
                            <h3 class="font-bold text-pink-300">【好きな曲】</h3>
                            <div class="w-full aspect-video rounded-md overflow-hidden bg-black">
                                <iframe
                                    class="w-full h-full"
                                    src={`https://www.youtube.com/embed/${band.videos.favorite}`}
                                    title="Favorite Song"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen>
                                </iframe>
                            </div>
                        </div>
			</div>
			{/* 動画エリア終わり */}
                </article>
            ))}
        </main>
    </body>
</html>

		<script>
			//必要な道具をインポートする
			import { gsap } from "gsap";
			import { ScrollTrigger } from "gsap/ScrollTrigger";

			//Gsapに「スクロール検知機能を使う」と伝える
			gsap.registerPlugin(ScrollTrigger)


			//1.タイトルのアニメーション
			// .header-title というクラスがついた要素を動かす
			gsap.to(".header-title",{
				opacity:1,  //透明度を1(見える状態にする)
				y:0,        //元の位置に戻す　(CSSで少しずらしておくと効果的)
				duration:1, //1秒かける
				delay: 0.5  //0.5秒待ってから開始
			});

			gsap.to(".header-subtitle",{
				opacity:1,   //透明度を1(見える状態にする)
				duration:1,  //1秒かける
				delay:1      //1秒待ってから開始
			});

			gsap.to("header-subtitle",{
				opacity: 1,
				duration: 1,
				delay: 1
			});



			//2.バンドカードのアニメーション
			const cards = document.querySelectorAll('.band-card'); //カードを全部探す

			cards.forEach((card) => { //1枚ずつ設定する
				gsap.to(card,{
					scrollTrigger: {
						trigger:card, //そのカードが
						start:"top 80%", //画面の下から20%の位置に来たら
						toggleActions: "play none none reverse", //通り過ぎたら戻す設定
						//markers:true, //これを入れるとマーカーが付けられる
					},
					opacity:1, //見えるようにする
					x:0, //位置を戻す
					duration:1, //1秒かけてふわっと
					ease: "power2.out" //新しく入れたとこ
				});
			});
		</script>
